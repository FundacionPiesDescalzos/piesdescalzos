<div class="inner-padding">
	<br /><br />
	<form action="/reports" method="get" class="inliner">
		<label> <span>Instituciones</span>
			<% seleccionado = params[:establishments][:establishment_id] if params[:establishments].present? && params[:establishments][:establishment_id].present? %>
			<%= select("establishments", "establishment_id", Establishment.all.collect {|p| [ p.name, p.id ] }, {include_blank: 'Todas', selected: seleccionado || ""}) %>
		</label>
		<label> <span>Departamentos</span>
			<% dep_seleccionado = params[:departments][:cities] if params[:departments].present? && params[:departments][:cities].present? %>
			<%= select("departments", "cities", GeneralInfo.departments, {include_blank: 'Todos', selected: dep_seleccionado || ""}) %>
		</label>
		<label> <span>Curso</span>
			<% cur_seleccionado = params[:course][:course_number] if params[:course].present? && params[:course][:course_number].present? %> 
		  <%= select("course", "course_number", 1..11, {include_blank: 'Todos', selected: cur_seleccionado || ""}) %>
		</label>
		<input type="submit" value="Consultar" class="button success right round" />
	</form>
	
	
	<br /><br />
<div class="row">
	<div class="large-6 medium-6 columns">
		<div id="gender"></div>
	</div>
	<div class="large-6 medium-6 columns">
		<div id="edad"></div>
	</div>
</div>
<br /><br />
<div class="row">
	<div class="large-6 medium-6 columns">
		<div id="container-speed"></div><br /><br />
		<div id="food" class="graph"></div>
	</div>
	<div class="large-6 medium-6 columns">
		<div id="etnic"></div>
	</div>
</div>
  <!-- <% @students.each do |student| %>
    <b><%= student.name %></b> <%= student.school.name %>
	<% end %> -->
	<script>
		$(function () {
		    $('#edad').highcharts({
		        chart: {
		            type: 'pie',
		        },
		        title: {
		            text: 'Clasificación por edad'
		        },
		        plotOptions: {
		            pie: {
		                innerSize: 100,
		                depth: 45
		            }
		        },
		        series: [{
		            data: [
		                ['menores de 8 años', <%= raw @under8 %>],
		                ['8 a 12 años', <%= raw @middle %>],
		                ['mayores de 12 años', <%= raw @pluls12 %>]
		            ]
		        }]
		    });
	
		    $('#gender').highcharts({
		        chart: {
		            type: 'pie',
		        },
						// colors: [
						// 			                '#7CB5EC','#FF9EBB'
						// 			            ],
		        title: {
		            text: 'Clasificación por genero'
		        },
		        plotOptions: {
		            pie: {
										allowPointSelect: true,
		                cursor: 'pointer',
		                dataLabels: {
		                    enabled: true,
		                    format: '<b>{point.name}</b>: {point.percentage:.1f} %'
		                }
		            }
		        },
		        series: [{
		            data: [
		                ['Niños', <%= raw @boys %>],
		                ['Niñas', <%= raw @girls %>]
		            ]
		        }]
		    });
				
	
		    $('#container-speed').highcharts({
		        chart: {
		            type: 'pie',
		        },
		        title: {
		            text: 'Porcentajes de desplazados, discapacitados, y retiros'
		        },
		        plotOptions: {
		            pie: {
		                innerSize: 100,
		                depth: 45,
										allowPointSelect: true,
		                cursor: 'pointer',
		                dataLabels: {
		                    enabled: true,
		                    format: '<b>{point.name}</b>: {point.percentage:.1f} %'
		                }
		            }
		        },
		        series: [{
		            data: [
		                ['Desplazados', <%= raw @displaced %>],
									  ['Discapacidad',<%= raw @disability %>],
									  ['Deserción',<%= raw @drop %>],
  									['Graduados',<%= raw @graduated %>]
		            ]
		        }]
		    });
				
				
		 // Create the chart
				var etnias = <%= raw @finish_etnias.to_json %>;
			  //console.log(etnias);
		    $('#etnic').highcharts({
		        chart: {
		            type: 'column'
		        },
		        title: {
		            text: 'Etnias'
		        },
		        xAxis: {
		            type: 'category'
		        },
		        legend: {
		            enabled: false
		        },
		        plotOptions: {
		            series: {
		                borderWidth: 0,
		                dataLabels: {
		                    enabled: true,
		                    format: '{point.y:.1f}%'
		                }
		            }
		        },
		        tooltip: {
		            headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
		            pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}%</b> of total<br/>'
		        },

		        series: [etnias]
		    });
       
        
				// NUTRITIONS
				
			  var food = <%= raw @results.to_json %> 
			  console.log(food, food["Delgadez"].girls)
	   	      $('#food').highcharts({
							chart: {
								          backgroundColor:'transparent',
				   	              plotBackgroundColor: null,
				   	              plotBorderWidth: null,
				   	              plotShadow: false,
							            type: 'pie'
							        },
							        title: {
							            text: 'Tablas de nutricion divididas por genero'
							        },
							        subtitle: {
							            text: 'Clic en la tabla para ver la diferenciación por genero'
							        },
							        xAxis: {
							            type: 'category'
							        },
							        yAxis: {
							            title: {
							                text: 'Cantidad total de nutrición'
							            }

							        },
							        legend: {
							            enabled: false
							        },
							        plotOptions: {
							            series: {
							                borderWidth: 0,
							                dataLabels: {
							                    enabled: true,
							                    format: '{point.y:.1f}%'
							                }
							            }
							        },
											colors: [
								                '#FFD41F', '#3D3B30', '#4D5061', '#5C80BC', '#E9EDDE'
								            ],
							        tooltip: {
							            headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
							            pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y}</b><br/>'
							        },
	   	          series: [{
	   	              name: 'Estudiantes en ',
	   	              colorByPoint: true,
	   	              data: [{
	   	                  name: "Riesgo de delgadez",
	   	                  y: food["Riesgo de delgadez"].data,
											  drilldown: 'Riesgo de delgadez'
	   	              }, {
	   	                  name: "Delgadez",
	   	                  y: food["Delgadez"].data,
												drilldown: "Delgadez"
	   	              }, {
	   	                  name: 'Adecuado para la edad',
	   	                  y: food["Adecuado para la edad"].data,
												drilldown: "Adecuado para la edad"
	   	              }, {
	   	                  name: 'Sobrepeso',
	   	                  y: food["Sobrepeso"].data,
												drilldown: "Sobrepeso"
	   	              }, {
	   	                  name: 'Obesidad',
	   	                  y: food["Obesidad"].data,
											  drilldown: "Obesidad"
	   	              }]
	   	          }],
								drilldown: {
									series: [{
										name: 'Riesgo de delgadez',
		                id: 'Riesgo de delgadez',
		                data: [["Niñas:", food["Riesgo de delgadez"].girls], ["Niños:", food["Riesgo de delgadez"].boys]]
									},
								  {
										name: 'Delgadez',
		                id: 'Delgadez',
		                data: [["Niñas:", food["Delgadez"].girls], ["Niños:", food["Delgadez"].boys]]
								  },
								  {
										name: 'Adecuado para la edad',
		                id: 'Adecuado para la edad',
		                data: [["Niñas:", food["Adecuado para la edad"].girls], ["Niños:", food["Adecuado para la edad"].boys]]
								  },
								  {
										name: 'Sobrepeso',
		                id: 'Sobrepeso',
		                data: [["Niñas:", food["Sobrepeso"].girls], ["Niños:", food["Sobrepeso"].boys]]
								  },
								  {
										name: 'Obesidad',
		                id: 'Obesidad',
		                data: [["Niñas:", food["Obesidad"].girls], ["Niños:", food["Obesidad"].boys]]
								  }]
								}
	   	      });

				
				// / NUTRITIONS
				
				
		});
		</script>
		<br />
		<br />
		<br />
</div>